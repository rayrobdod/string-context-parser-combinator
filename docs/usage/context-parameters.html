<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Context Parameters</title><link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"></link><script type="text/javascript" src="../../scripts/searchData.js" defer="true"></script><link rel="stylesheet" href="../../styles/nord-light.css"></link><link rel="stylesheet" href="../../styles/scalastyle.css"></link><link rel="stylesheet" href="../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../styles/diagram.css"></link><link rel="stylesheet" href="../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../styles/search-bar.css"></link><link rel="stylesheet" href="../../styles/scaladoc-searchbar.css"></link><script type="text/javascript" src="../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../scripts/searchbar.js" defer="true"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="../../scripts/data.js" defer="true"></script><script>var pathToRoot = "../../";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><div class="projectName">string-context-parser-combinator</div></span><span><div class="projectVersion">SNAPSHOT</div></span><div class="socials"><a href="https://github.com/rayrobdod/string-context-parser-combinator"><span class="social-icon" data-icon-path="github-icon-white.png"></span></a></div></div><div id="paneSearch"></div><nav id="sideMenu2"><div class="expanded"><a href="#" class="selected expanded">string-context-parser-combinator</a><span class="ar"></span><div class="expanded"><a href="index.html">usage</a><span class="ar"></span><div><a href="context-parameters.html" class="selected expanded">Context Parameters</a></div></div><div><a href="../../index.html">index</a></div><div><a href="../../api/index.html">API</a><span class="ar"></span><div><a href="../../api/com/rayrobdod/stringContextParserCombinator.html"><span class="micon p"></span>com.rayrobdod.stringContextParserCombinator</a><span class="ar"></span><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/CodePoint.html"><span class="micon c"></span>CodePoint</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Failure.html"><span class="micon c"></span>Failure</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Input.html"><span class="micon c"></span>Input</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/LiftFunction.html"><span class="micon t"></span>LiftFunction</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Parser.html"><span class="micon t"></span>Parser</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Parsers$.html"><span class="micon o"></span>Parsers</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Position.html"><span class="micon t"></span>Position</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Position$.html"><span class="micon o"></span>Position</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Result.html"><span class="micon t"></span>Result</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/Success.html"><span class="micon c"></span>Success</a></div></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel.html"><span class="micon p"></span>com.rayrobdod.stringContextParserCombinator.typelevel</a><span class="ar"></span><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Eithered.html"><span class="micon t"></span>Eithered</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Eithered$.html"><span class="micon o"></span>Eithered</a><span class="ar"></span><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Eithered$$unitAny.html"><span class="micon g"></span>unitAny</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Eithered$$anyUnit.html"><span class="micon g"></span>anyUnit</a></div></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Optionally.html"><span class="micon t"></span>Optionally</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Optionally$.html"><span class="micon o"></span>Optionally</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Repeated.html"><span class="micon t"></span>Repeated</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Repeated$.html"><span class="micon o"></span>Repeated</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Sequenced.html"><span class="micon t"></span>Sequenced</a></div><div><a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel/Sequenced$.html"><span class="micon o"></span>Sequenced</a></div></div></div></div></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="scaladoc-searchBar"></div><main><div id="content"><div class="breadcrumbs"><a href="#">string-context-parser-combinator</a>/<a href="index.html">usage</a>/<a href="context-parameters.html">Context Parameters</a></div><div><html>
 <head></head>
 <body>
  <p>The Parser methods <code>andThen</code>, <code>orElse</code>, <code>repeat</code> and <code>optionally</code> each take a context parameter which describes how to combine the results of the aggregate parser's components. Each of these types reside in <a href="../../api/com/rayrobdod/stringContextParserCombinator/typelevel.html">com.rayrobdod.stringContextParserCombinator.typelevel</a>. Each of these four types' companion object defines one low-priority given instance that accepts any type and produces an appropriate generic result. The companion object also defines additional instances for more specific types, usually to avoid sticking <code>scala.Unit</code> values in a collection, and maybe a few more for common use cases.</p> 
  <p>Defining custom instances of these types is supported. Making custom given instances can significantly reduce the number of explicit <code>map</code> calls required when writing a parser, however the usual advice with <a href="https://dotty.epfl.ch/docs/reference/contextual/givens.html">given instances</a> applies: keep types specific, or keep the scope of a given instance to the minimum viable to prevent given instances from becoming confusing.</p> 
  <h1><a href="#sequenced" id="sequenced" class="anchor"></a>Sequenced</h1> 
  <p>The fallback given sequenced places the two items in a tuple.</p> 
  <p>The <code>Unit</code>-handling sequenced values drop the unit value.</p> 
  <pre><code class="language-scala">(p1:Parser[A] andThen p2:Parser[Unit]):Parser[A]
</code></pre> 
  <p>Below is example of providing and using custom Sequenced.</p> 
  <pre><code class="language-scala">import java.time._

given (using Quotes): Sequenced[LocalDate, LocalTime, LocalDateTime] with {
	def aggregate(date:LocalDate, time:LocalTime):LocalDateTime = date.atTime(time)
}

(dateParser:Parser[LocalDate] andThen IsString("T") andThen timeParser:Parser[LocalTime]):Parser[LocalDateTime]
</code></pre> 
  <h1><a href="#eithered" id="eithered" class="anchor"></a>Eithered</h1> 
  <p>The fallback given Eithered creates a union type of the two component types.</p> 
  <p>The default given instances of Eithered which handle one Unit type summon a <code>Optionally</code> instance and treat the non-Unit-typed value as a present value and the Unit-typed value as a missing value</p> 
  <pre><code class="language-scala">(p1:Parser[A] orElse p2:Parser[Unit]):Parser[Option[A]]
</code></pre> 
  <p>A non-given instance of Eithered is provided, named <code>discriminatedUnion</code>, that instead places the two values in a <code>scala.Either</code>.</p> 
  <pre><code class="language-scala">val evenOdd:Parser[Either[Char, Char]] = CharIn("02468").orElse(CharIn("13579"))(using Eithered.discriminatedUnion)
</code></pre> 
  <h1><a href="#repeated" id="repeated" class="anchor"></a>Repeated</h1> 
  <p>The fallback given Sequenced places the items in a <code>scala.Seq</code>.</p> 
  <p>In addition to the given object which combines <code>scala.Unit</code> values into a single <code>scala.Unit</code>, there are two built-in given objects which combine Char values or CodePoint values into a String.</p> 
  <pre><code class="language-scala">(CharIn("abcde"):Parser[Char]).repeat():Parser[String]
</code></pre> 
  <p>Below is example of providing and using custom Repeated.</p> 
  <pre><code class="language-scala">// define the marker types
/** represents a single digit */
case class Digit(value:Int)
/** represents a sequence of digits */
case class Digits(value:Int)

// define the given instance
given Repeated[Digit, Digits] with {
	final class Box(var value:Int)
	type Acc = Box
	def init():Acc = new Box(0)
	def append(acc:Acc, elem:Digit):Unit = {acc.value *= 10; acc.value += elem.value}
	def result(acc:Acc):Digits = new Digits(acc.value)
}

// create the parsers
val digit:Parser[Digit] = CharIn('0' to '9').map(x =&gt; Digit(x - '0'))
val digits:Parser[Digits] = digit.repeat(1) // using the given Repeated[Digit, Digits]
</code></pre> 
  <h1><a href="#optionally" id="optionally" class="anchor"></a>Optionally</h1> 
  <p>The fallback given Optionally places the items in a <code>scala.Option</code>, wrapping a found value in a Some and using a None as the empty value.</p> 
  <p>The <code>Unit</code>-handling Optionally value doesn't wrap a present <code>()</code> in an Option, and uses <code>()</code> as a default value.</p> 
  <pre><code class="language-scala">(IsString("0x"):Parser[Unit]).optionally():Parser[Unit]
</code></pre> 
 </body>
</html></div></div></main><footer><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span>&nbsp;Back to top</a></span><div class="socials">Social links&nbsp;<a href="https://github.com/rayrobdod/string-context-parser-combinator"><span class="social-icon" data-icon-path="github-icon-black.png"></span></a></div><div id="generated-by">Generated by&nbsp;<a href="https://github.com/lampepfl/dotty/tree/master/scaladoc"><img src="../../images/scaladoc_logo.svg" alt="scaladoc" class="scaladoc_logo"></img></a></div></footer></div></div></body></html>